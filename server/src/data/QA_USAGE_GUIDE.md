# AI 채팅 시스템 사용 가이드

## 개요

이 AI 채팅 시스템은 OpenAI API 대신 로컬 모델(키워드 매칭 기반)을 사용하여 쇼핑몰 고객의 질문에 답변하고 액션을 수행합니다.

## 주요 기능

### 1. 상품 검색
- 자연어로 상품 검색
- 예: "프라이팬 찾아줘", "냄비 검색", "주방용품 추천해줘"

### 2. 장바구니 담기
- 상품명으로 장바구니에 추가
- 예: "프라이팬 장바구니에 담아줘", "이거 담아줘"

### 3. 로그인/회원가입
- 로그인/회원가입 페이지로 이동
- 예: "로그인하고 싶어", "회원가입"

### 4. 주문 조회
- 주문 내역 및 배송 조회
- 예: "주문 내역 보여줘", "배송 조회"

### 5. 정책 문의
- 배송비, 무료배송 기준, 반품/교환 정책 등
- 예: "배송비 얼마야?", "무료배송 기준이 뭐야?"

## QA 데이터베이스 구조

`server/src/data/qaDatabase.json` 파일에 질문-답변 데이터가 저장되어 있습니다.

### 구조
```json
{
  "categories": [
    {
      "category": "카테고리명",
      "keywords": ["키워드1", "키워드2", ...],
      "questions": [
        {
          "question": "기본 질문",
          "variations": ["변형 질문1", "변형 질문2", ...],
          "answer": "답변 텍스트",
          "action": "액션 타입",
          "params": {}
        }
      ]
    }
  ]
}
```

### 액션 타입
- `search`: 상품 검색
- `addToCart`: 장바구니 담기
- `navigate`: 페이지 이동 (login, signup)
- `viewOrders`: 주문 조회
- `trackDelivery`: 배송 조회
- `cancelOrder`: 주문 취소
- `requestRefund`: 환불 신청
- `writeReview`: 리뷰 작성
- `checkRewards`: 적립금 조회
- `checkCoupons`: 쿠폰 조회
- `answer`: 단순 답변

## 질문 추가 방법

1. `server/src/data/qaDatabase.json` 파일 열기
2. 적절한 카테고리 찾기 (없으면 새로 생성)
3. `questions` 배열에 새 질문 추가:

```json
{
  "question": "새 질문",
  "variations": ["변형1", "변형2"],
  "answer": "답변",
  "action": "액션타입",
  "params": {}
}
```

4. 카테고리의 `keywords` 배열에 관련 키워드 추가

## 키워드 매칭 시스템

`server/src/utils/localChatModel.js`에서 키워드 기반 매칭을 수행합니다.

### 매칭 우선순위
1. 정확한 질문 일치
2. 변형 질문 매칭
3. 카테고리 키워드 매칭
4. 단어별 매칭

### 유사도 점수
- 정확한 일치: 100점
- 변형 질문 매칭: 20점
- 카테고리 키워드: 15점
- 단어 매칭: 5-10점

최소 10점 이상이어야 매칭으로 인정됩니다.

## 확장 방법

### 새로운 액션 추가
1. `localChatModel.js`의 `processMessage` 메서드에 액션 처리 로직 추가
2. `chatController.js`의 `sendChatMessage` 함수에 액션 실행 로직 추가
3. `qaDatabase.json`에 해당 액션을 사용하는 질문 추가

### 검색 기능 개선
- `extractProductName` 메서드를 수정하여 더 정확한 상품명 추출
- 검색 쿼리 확장 로직 추가

## 주의사항

1. **로그인 필요 기능**: 장바구니 담기, 주문 조회 등은 로그인 상태를 확인해야 합니다.
2. **상품명 추출**: 자연어에서 상품명을 정확히 추출하는 것이 중요합니다.
3. **키워드 관리**: 카테고리별 키워드를 잘 관리하여 정확한 매칭을 유지해야 합니다.

